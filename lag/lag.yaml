components:
  schemas:
    Lag:
      x-include: 
      - '../common/common.yaml#/components/schemas/Named.Object'
      description: >-
        A container for LAG settings.
      type: object
      required: [protocol]
      properties:
        port_names:
          description: >- 
            A list of unique names of port objects that will be part of the 
            same lag. 

            The number of port_names becomes the count for any child 
            property in this hierarchy that is a container for a
            Pattern.Lag... or Pattern.Device... schema object.
          type: array
          items:
            type: string
            x-constraint:
            - '/components/schemas/Port/properties/name'
        protocol:
          $ref: '#/components/schemas/Lag.Protocol'
        ethernet:
          $ref: '../device/ethernet.yaml#/components/schemas/Device.Ethernet'

    Lag.Protocol:
      type: object
      required: [choice]
      properties:
        choice:
          description: >-
            The type of lag protocol.
          type: string
          enum: [lacp, static]
        lacp:
          $ref: '#/components/schemas/Lag.Lacp'
        static:
          $ref: '#/components/schemas/Lag.Static'

    Lag.Static:
      description: >-
        The container for link aggregation static protocol settings.
      type: object
      properties:
        lag_id:
          x-device-pattern:
            description: >-
              The static lag id.
            format: integer
            default: 0

    Lag.Lacp:
      description: >-
        The container for link aggregation control protocol settings.
      type: object
      properties:
        actor_key:
          x-device-pattern:
            description: >-
              The actor key.
            format: string
        actor_port_number:
          x-device-pattern:
            description: >-
              The actor port number.
            format: integer
            default: 0
        actor_port_priority:
          x-device-pattern:
            description: >-
              The actor port priority.
            format: integer
            default: 0
        actor_system_id:
          x-device-pattern:
            description: >-
              The actor system id.
            format: integer
            default: 0
        actor_system_priority:
          x-device-pattern:
            description: >-
              The actor system priority.
            format: integer
            default: 0

