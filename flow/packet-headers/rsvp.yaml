components:
  schemas:
    Flow.Rsvp:
      description: RSVP packet header as defined in RFC2205 and RFC3209.
      type: object
      properties:
        version:
          x-field-pattern:
            description: >-
              Protocol Version number. 
            format: integer
            length: 4
            default: 1
            features: [count]
          x-field-uid: 1
        flag:
          x-field-pattern:
            description: >-
              Flag, 0x01-0x08: Reserved.No flag bits are defined yet. 
            format: integer
            length: 4
            default: 0
            features: [count]
          x-field-uid: 2
        message_type:
          x-field-pattern:
            description: >-
              An 8-bit number that identifies the function of the RSVP message.
              There are aound 20 message types is defined https://www.iana.org/assignments/rsvp-parameters/rsvp-parameters.xhtml#rsvp-parameters-2 .
              Among Those we are presently supporting "path"(value: 1) and "hello" (value: 20) message type.
            x-constants:
              default: 1
              path: 1
              hello: 20 
            format: integer
            length: 8
            features: [count]
          x-field-uid: 3
        rsvp_checksum:
          x-field-pattern:
            description: >-
              The one's complement of the one's complement sum of the message, with the checksum field replaced by zero for the purpose of computing the checksum.  
              An all-zero value means that no checksum was transmitted.
            format: checksum
            length: 16
          x-field-uid: 4
        time_to_live:
          x-field-pattern:
            description: >-
              The IP time-to-live(TTL) value with which the message was sent.
            format: integer
            length: 8
            default: 0
            features: [count]
          x-field-uid: 5
        reserved:
          x-field-pattern:
            description: >-
              Reserved 
            format: integer
            length: 8
            default: 0
            features: [count]
          x-field-uid: 6
        rsvp_length:
          x-field-pattern:
            description: >-
              The sum of the lengths of the common header and all objects included in the message.
            format: integer
            default: auto
            length: 16
            features: [auto, count]
          x-field-uid: 7
        objects:
          type: array
          minItems: 1
          items:
            $ref: '#/components/schemas/Flow.RSVP.Objects'
          x-field-uid: 8
    Flow.RSVP.Objects:
      description: >-
        Every RSVP object encapsulated in an RSVP message consists of a 32-bit word header and the object's contents.
      type: object
      properties:
        length:
          x-field-pattern:
            description: >-
              Contains the total length of the object including the object's header, measured in bytes. 
              Objects must be aligned to 32-bit words. 
            format: integer
            length: 16
            default: 4
            features: [count]
          x-field-uid: 1
        class_num:
          x-field-pattern:
            description: >-
              The class number is used to identify the class of an object. Defined in https://www.iana.org/assignments/rsvp-parameters/rsvp-parameters.xhtml#rsvp-parameters-4 .
              Curently supported class numbers are for "path" and "hello" message types.
              "path" message:
              Supported Class numbers: SESSION: 1, RSVP_HOP: 3, TIME_VALUES: 5, SENDER_TEMPLATE: 11, SENDER_TSPEC: 12, LABEL_REQUEST: 19, EXPLICIT_ROUTE: 20,  RECORD_ROUTE: 21, SESSION_ATTRIBUTE: 207
              "hello" message:
              Supported Class numbers: HELLO: 22
            format: integer
            length: 8
            default: 1
            features: [count]
          x-field-uid: 2
        c_type:
          x-field-pattern:
            description: >-
              Object type, unique within Class-Num. Defined in https://www.rfc-editor.org/rfc/rfc2205.html#page-77 .
            format: integer
            length: 8
            default: 1
            features: [count]
          x-field-uid: 3
        object_contents:
          $ref: '#/components/schemas/Flow.RSVP.ObjectConent'
          x-field-uid: 4
    Flow.RSVP.ObjectConent:
      description: >-
        The body of an object corresponding to the class number and c-type. The maximum object content length is 65528 bytes.
        The Class-Num and C-Type fields may be used together as a 16-bit number to define a unique type for each object.
        Currently supported objects are:
        1. LSP Tunnel IPv4: Class=1 (SESSION), C-Type=7.
        2. IPv4: Class=3 (RSVP_HOP), C-Type=1.
        3. Type 1 Time Value: Class=5 (TIME_VALUES), C-Type=1.
        4. LSP Tunnel IPv4: Class=11 (SENDER_TEMPLATE), C-Type=7.
        5. Int-serv: Class=12 (SENDER_TSPEC), C-Type=2.
        6. Without Label Range: Class=19 (LABEL_REQUEST), C-Type=1.
        7. Type 1 Explicit Route: Class=20 (EXPLICIT_ROUTE), C-Type=1.
        8. IPv4 address: Class=21 (ROUTE_RECORD), C-Type=1.
        9. Request: Class=22 (HELLO), C-Type=1.
        10. Acknowledgement: Class=22 (HELLO), C-Type=2.
        11. LSP_TUNNEL_RA: Class=207 (SESSION_ATTRIBUTE), C-Type=1.
        12. LSP Tunnel: Class=207 (SESSION_ATTRIBUTE), C-Type=2.
        13. Custom: User defined bytes based on class and c-types not suppored in above options.
      type: object
      properties:
        choice:
          type: string
          default: custom
          x-field-uid: 1
          x-enum:
            session_lsp_tunnel_ipv4:
              x-field-uid: 1
            rsvp_hop_ipv4:
              x-field-uid: 2
            type_1_time_value:
              x-field-uid: 3
            sender_template_lsp_tunnel_ipv4:
              x-field-uid: 4
            int_serv:
              x-field-uid: 5
            without_label_range:
              x-field-uid: 6
            type_1_explicit_route:
              x-field-uid: 7
            route_record_ipv4_address:
              x-field-uid: 8
            hello_request:
              x-field-uid: 9
            hello_acknowledgement:
              x-field-uid: 10
            session_attribute_lsp_tunnel_ra:
              x-field-uid: 11
            session_attribute_lsp_tunnel:
              x-field-uid: 12
            custom:
              x-field-uid: 13

