components:
  schemas:
    Device.Ipv4Base:
      x-include: 
      - '../common/common.yaml#/components/schemas/Named.Object'
      description: >-
        A base IPv4 interface.
      type: object
      required: [address]
      properties:
        address:
          description: >-
            The IPv4 address
          type: string
          format: ipv4
        prefix:
          description: >-
            The prefix of the IPv4 address.
          type: integer
          minimum: 1
          maximum: 32
          default: 24

    Device.Ipv4:
      x-include: 
      - '#/components/schemas/Device.Ipv4Base'
      description: >-
        An IPv4 interface with gateway
      type: object
      required: [gateway]
      properties:
        gateway:
          description: >-
            The IPv4 address of the gateway
          type: string
          format: ipv4
        manual_gateway_mac: 
          $ref: '#/components/schemas/Device.Ipv4ManualGatewayMAC'
          
    # Can not derive LoopbackIpv4 from Ipv4Base as default prefix length must be 32.
    Device.Ipv4Loopback:
      x-include: 
      - '../common/common.yaml#/components/schemas/Named.Object'
      description: >-
        An IPv4 Loopback interface.
      type: object
      required: [eth_name]
      properties:
        eth_name: 
          description: >-
            The unique name of the Ethernet interface behind which this Loopback 
            interface will be created.
          type: string
          x-constraint:
          - '/components/schemas/Device.Ethernet/properties/name'
        address:
          description: >-
            The IPv4 Loopback address with prefix length of 32.
          type: string
          format: ipv4
          default: 0.0.0.0

    Device.Ipv4ManualGatewayMAC:
      description: >- 
        By default the destination MAC used for control and data packets sent from this IPv4 endpoint is learnt by sending ARP Requests to the configured gateway IP.
         Enabling this would mean that ARP will not be used for learning MAC of connected device.
          This is needed if ARP resolution is not possible in some scenario with the device where the gateway is configured.
      type: object
      properties:
        enable:
          description: >-
            manual_gateway_mac enable, set to True or False
          type: boolean
          default: false
        address:
          description: >-
            When manual_gateway_mac enable is set to true, this user-configured MAC address will be used for auto-filling 
            the destination MAC address in the control and data packets sent from this IPv4 endpoint whenever applicable.
             This MAC must match the MAC of the interface on the connected device where the gateway_ip is configured.
          type: string
          format: mac
    
    

