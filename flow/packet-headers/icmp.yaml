components:
  schemas:
    Flow.Icmp:
      description: ICMP packet header
      type: object
      required: [choice]
      properties:
        choice:
          type: string
          enum: [icmp_echo]
        icmp_with_next_fields:
          $ref: '#/components/schemas/Flow.ICMPEcho'

    Flow.ICMPEcho:
      x-include: 
      - '.#/components/schemas/Flow.ICMP.NextFields'
      description: Packet Header for ICMP Echo
      type: object
      properties:
        type:
          x-field-pattern:
            x-constants:
              echo_reply: 0
              echo_request: 8
            description: >-
              type of ICMP Echo
            format: integer
            length: 8
            default: 8
            features: [count, metric_group]
        code:
          x-field-pattern:
            description: >-
              code of ICMP with next fields
            format: integer
            length: 1
            default: 0
            features: [count, metric_group]

    Flow.ICMP.NextFields:
      description: Next Fields for ICMP that contains ID, Seq Number and Next Fields
      type: object
      properties:
        checksum:
          x-field-pattern:
            description: >-
              checksum of ICMP with next fields
            format: checksum
            length: 16
        identifier:
          x-field-pattern:
            description: >-
              identifier of ICMP with next fields
            format: integer
            length: 16
            default: 0
            features: [count, metric_group]
        sequence_number:
          x-field-pattern:
            description: >-
              sequence number of ICMP with next fields
            format: integer
            length: 16
            default: 0
            features: [count, metric_group]
        next_fields:
          x-field-pattern:
            description: >-
              next fields
            format: integer
            length: 32
            default: 0
            features: [count, metric_group]
        
    


    
    
    
              
