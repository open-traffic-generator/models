components:
  schemas:
    Flow.Icmp:
      description: ICMP packet header
      type: object
      required: [choice]
      properties:
        choice:
          type: string
          enum: [icmp_with_next_fields, icmp_with_next4bytes, icmp_router_advertisement]
        icmp_with_next_fields:
          $ref: '#/components/schemas/Flow.ICMPWithNextFields'
        icmp_with_next4bytes:
          $ref: '#/components/schemas/Flow.ICMPWithNext4Bytes'
        icmp_router_advertisement:
          $ref: '#/components/schemas/Flow.ICMP.Router.Advertisement'

    Flow.ICMPWithNextFields:
      description: Packet Header for ICMP with next fields
      type: object
      properties:
        type:
          x-field-pattern:
            x-constants:
              echo_reply: 0
              echo_request: 8
              timestamp: 13
              timestamp_reply: 14
              information_request: 15
              information_reply: 16
            description: >-
              type of ICMP with next fields
            format: integer
            length: 8
            default: 8
            features: [count, metric_group]
        code:
          x-field-pattern:
            description: >-
              code of ICMP with next fields
            format: integer
            length: 8
            default: 0
            features: [count, metric_group]
        checksum:
          x-field-pattern:
            description: >-
              checksum of ICMP with next fields
            format: checksum
            length: 16
        identifier:
          x-field-pattern:
            description: >-
              identifier of ICMP with next fields
            format: integer
            length: 16
            default: 0
            features: [count, metric_group]
        sequence_number:
          x-field-pattern:
            description: >-
              sequence number of ICMP with next fields
            format: integer
            length: 16
            default: 0
            features: [count, metric_group]
        next_fields:
          x-field-pattern:
            description: >-
              next fields
            format: integer
            length: 32
            default: 0
            features: [count, metric_group]
        
    Flow.ICMPWithNext4Bytes:
      description: Packet Header for ICMP Next 4 Bytes
      type: object
      properties:
        type:
          x-field-pattern:
            x-constants:
              Destination Unreachable: 3
              Source Quench: 4
              Redirect Message: 5
              Time Exceeded: 11
              Parameter Problem: 12
            description: >-
              type of ICMP Next 4 Bytes
            format: integer
            length: 8
            default: 1
            features: [count, metric_group]
        code:
          x-field-pattern:
            description: >-
              code of ICMP Next 4 Bytes
            format: integer
            length: 8
            default: 0
            features: [count, metric_group]
        checksum:
          x-field-pattern:
            description: >-
              checksum of ICMP Next 4 Bytes
            format: checksum
            length: 16
        next_4_bytes:
          x-field-pattern:
            description: >-
              next 4 bytes
            format: integer
            length: 32
            default: 0
            features: [count, metric_group]

    Flow.ICMP.Router.Advertisement:
      description: Packet Header for ICMP Router Advertisement
      type: object
      properties:
        type:
          x-field-pattern:
            description: >-
              type of ICMP Router Advertisement
            format: integer
            length: 8
            default: 9
            features: [count, metric_group]
        code:
          x-field-pattern:
            description: >-
              code of ICMP Router Advertisement
            format: integer
            length: 8
            default: 0
            features: [count, metric_group]
        checksum:
          x-field-pattern:
            description: >-
              checksum of ICMP Router Advertisement
            format: checksum
            length: 16
        num_addr:
          x-field-pattern:
            description: >-
              number of addresses of ICMP Router Advertisement
            format: integer
            length: 8
            default: 1
            features: [count, metric_group]
        addr_entry_size:
          x-field-pattern:
            description: >-
              address entry size of ICMP Router Advertisement
            format: integer
            length: 8
            default: 2
            features: [count, metric_group]
        lifetime:
          x-field-pattern:
            description: >-
              lifetime of ICMP Router Advertisement
            format: integer
            length: 16
            default: 10
            features: [count, metric_group]
        router_addr_entries:
          description: >-
            router address entries of ICMP Router Advertisement
          type: array
          items:
            $ref: '#/components/schemas/Flow.ICMP.Router.Address.Entries'

    Flow.ICMP.Router.Address.Entries:
      description: Packet Header for ICMP Router Address Entries
      type: object
      properties:
        router_addr:
          x-field-pattern:
            description: >-
              router address of ICMP Router Advertisement
            format: ipv4
            length: 32
            default: 0.0.0.0
            features: [count, metric_group]
        router_preference:
          x-field-pattern:
            description: >-
              router preference of ICMP Router Advertisement
            format: integer
            length: 32
            default: 0
            features: [count, metric_group]


    
    
    
              
