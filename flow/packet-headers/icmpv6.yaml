components:
  schemas:
    Flow.Icmpv6:
      description: ICMPv6 packet header
      type: object
      required: [choice]
      properties:
        choice:
          type: string
          enum: [dest_unreach, packet_too_big, time_exceeded, parameter_problem, echo_request, echo_reply]
        dest_unreach:
          $ref: '#/components/schemas/Flow.ICMPv6DestUnreach'
        packet_too_big:
          $ref: '#/components/schemas/Flow.ICMPv6PacketTooBig'
        time_exceeded:
          $ref: '#/components/schemas/Flow.ICMPv6TimeExceeded'
        parameter_problem:
          $ref: '#/components/schemas/Flow.ICMPv6ParamProblem'
        echo_request:
          $ref: '#/components/schemas/Flow.ICMPv6EchoRequest'
        echo_reply:
          $ref: '#/components/schemas/Flow.ICMPv6EchoReply'
        
    Flow.ICMPv6DestUnreach:
      description: Packet Header for ICMPv6 Destination Unreachable Message
      type: object
      properties:
        type:
          x-field-pattern:
            description: >-
              type of ICMPv6 Destination Unreachable Message
            format: integer
            length: 8
            default: 1
            features: [count, metric_group]
        code:
          x-field-pattern:
            x-constants:
              No route to destination: 0
              Communication with destination administratively prohibited: 1
              Beyond scope of source address: 2
              Address unreachable: 3
              Port unreachable: 4
            description: >-
              code of ICMPv6 Destination Unreachable Message
            format: integer
            length: 8
            default: 0
            features: [count, metric_group]
        checksum:
          x-field-pattern:
            description: >-
              checksum of ICMPv6 Destination Unreachable Message
            format: checksum
            length: 16
        unused:
          x-field-pattern:
            description: >-
              unused 
            format: integer
            length: 32
            default: 0
            features: [count, metric_group]

    Flow.ICMPv6PacketTooBig:
      description: Packet Header for ICMPv6 Packet Too Big Message
      type: object
      properties:
        type:
          x-field-pattern:
            description: >-
              type of ICMPv6 Packet Too Big Message
            format: integer
            length: 8
            default: 2
            features: [count, metric_group]
        code:
          x-field-pattern:
            description: >-
              code of ICMPv6 Packet Too Big Message
            format: integer
            length: 8
            default: 0
            features: [count, metric_group]
        checksum:
          x-field-pattern:
            description: >-
              checksum of ICMPv6 Packet Too Big Message
            format: checksum
            length: 16
        max_transmission_limit:
          x-field-pattern:
            description: >-
              Maximum Transmission Limit of ICMPv6 Packet Too Big Message
            format: integer
            length: 32
            default: 1500
            features: [count, metric_group]

    Flow.ICMPv6TimeExceeded:
      description: Packet Header for ICMPv6 Time Exceeded
      type: object
      properties:
        type:
          x-field-pattern:
            description: >-
              type of ICMPv6 Time Exceeded
            format: integer
            length: 8
            default: 3
            features: [count, metric_group]
        code:
          x-field-pattern:
            x-constants:
              Hop limit exceeded in transit: 0
              Fragment reassembly time exceeded: 1
            description: >-
              code of ICMPv6 Time Exceeded
            format: integer
            length: 8
            default: 0
            features: [count, metric_group]
        checksum:
          x-field-pattern:
            description: >-
              checksum of ICMPv6 Time Exceeded
            format: checksum
            length: 16
        unused:
          x-field-pattern:
            description: >-
              unused 
            format: integer
            length: 32
            default: 0
            features: [count, metric_group]

    Flow.ICMPv6ParamProblem:
      description: Packet Header for ICMPv6 Parameter Problem
      type: object
      properties:
        type:
          x-field-pattern:
            description: >-
              type of ICMPv6 Parameter Problem
            format: integer
            length: 8
            default: 4
            features: [count, metric_group]
        code:
          x-field-pattern:
            x-constants:
              Erroneous header field encountered: 0 
              Unrecognized Next Header type encountered: 1
              Unrecognized IPv6 option encountered: 2
            description: >-
              code of ICMPv6 Parameter Problem
            format: integer
            length: 8
            default: 0
            features: [count, metric_group]
        checksum:
          x-field-pattern:
            description: >-
              checksum of ICMPv6 Parameter Problem
            format: checksum
            length: 16
        pointer:
          x-field-pattern:
            description: >-
              pointer
            format: integer
            length: 32
            default: 0
            features: [count, metric_group]

    Flow.ICMPv6EchoRequest:
      description: Packet Header for ICMPv6 Echo Request
      type: object
      properties:
        type:
          x-field-pattern:
            description: >-
              type of ICMPv6 Echo Request
            format: integer
            length: 8
            default: 128
            features: [count, metric_group]
        code:
          x-field-pattern:
            description: >-
              code of ICMPv6 Echo Request
            format: integer
            length: 8
            default: 0
            features: [count, metric_group]
        checksum:
          x-field-pattern:
            description: >-
              checksum of ICMPv6 Echo Request
            format: checksum
            length: 16
        identifier:
          x-field-pattern:
            description: >-
              identifier of ICMPv6 Echo Request
            format: integer
            length: 16
            default: 0
            features: [count, metric_group]
        sequence_number:
          x-field-pattern:
            description: >-
              sequence number of ICMPv6 Echo Request
            format: integer
            length: 16
            default: 0
            features: [count, metric_group]

    Flow.ICMPv6EchoReply:
      description: Packet Header for ICMPv6 Echo Reply
      type: object
      properties:
        type:
          x-field-pattern:
            description: >-
              type of ICMPv6 Echo Reply
            format: integer
            length: 8
            default: 129
            features: [count, metric_group]
        code:
          x-field-pattern:
            description: >-
              code of ICMPv6 Echo Reply
            format: integer
            length: 8
            default: 0
            features: [count, metric_group]
        checksum:
          x-field-pattern:
            description: >-
              checksum of ICMPv6 Echo Reply
            format: checksum
            length: 16
        identifier:
          x-field-pattern:
            description: >-
              identifier of ICMPv6 Echo Reply
            format: integer
            length: 16
            default: 0
            features: [count, metric_group]
        sequence_number:
          x-field-pattern:
            description: >-
              sequence number of ICMPv6 Echo Reply
            format: integer
            length: 16
            default: 0
            features: [count, metric_group]
    
    
              
