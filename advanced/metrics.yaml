components:
  schemas:
    AdvancedMetrics.Request:
      type: object
      required: [flow_names, metric]
      properties:
        flow_names:
          type: array
          items:
            type: string
            x-constraint:
            - '/components/schemas/Flow/properties/name'
        metric:
          type: string
          enum: [timestamps, latency, convergence]
          default: timestamps

    AdvancedMetrics.Response:
      type: object
      properties:
        choice:
          type: string
          enum: [timestamp_metrics, latency_metrics, convergence_metrics]
        timestamp_metrics:
          type: array
          items:
            $ref: '#/components/schemas/AdvancedMetrics.Timestamp'
        latency_metrics:
          type: array
          items:
            $ref: '#/components/schemas/AdvancedMetrics.Latency'
        convergence_metrics:
          type: array
          items:
            $ref: '#/components/schemas/AdvancedMetrics.Convergence'

    AdvancedMetrics.Timestamp:
      description: |-
        The container for timestamp metrics.
      type: object
      properties:
        flow_name:
          description: |-
            The name of the source.
            Flow + metric group?
          type: string
          example: 'Tx Port -> Rx Port'
        first_timestamp_ns:
          description: |-
            First timestamp in nanoseconds
          type: number
          format: double
        last_timestamp_ns:
          description: |-
            Last timestamp in nanoseconds
          type: number
          format: double

    AdvancedMetrics.Latency:
      description: |-
        The container for latency metrics. The min/max/avg values are dependent 
        on the type of latency measurement mode that is configured.
      type: object
      properties:
        flow_name:
          description: |-
            The name of the source.
            Flow + metric group?
          type: string
          example: 'Tx Port -> Rx Port'
        minimum_ns:
          description: |-
            Minimum latency in nanoseconds
          type: number
          format: double
        maximum_ns:
          description: |-
            Maximum latency in nanoseconds
          type: number
          format: double
        average_ns:
          description: |-
            Average latency in nanoseconds
          type: number
          format: double

    AdvancedMetrics.Convergence:
      description: |-
        The container for data plane and control plane convergence metrics
      type: object
      properties:
        flow_name:
          description: |-
            The name of the flow that is affected by the trigger event.
          type: string
          x-constraint:
          - '/components/schemas/Flow/properties/name'
          example: 'Tx Port -> Rx Port'
        data_plane_convergence_ns:
          description: |-
            The convergence time measured from the data plane perspective only. 
            It measures the time from BTT, when the rate on Test Port 2 crosses 
            below the Rx Threshold until an acceptable amount of traffic was 
            received at time ATT, when the rate crosses above the Rx Threshold.
          type: number
          format: double
        control_plane_data_plane_convergence_ns:
          description: |-
            The total convergence time, between the event that caused the
            switchover (at tEvent) until an acceptable amount of traffic was 
            received at time ATT, when the rate crosses above the Rx Threshold.
          type: number
          format: double
        service_interruption_time_ns:
          description: |-
            Service interruption time is the flow_rx_rate_above_threshold - the
            flow_rx_rate_below_threshold.
          type: number
          format: double
