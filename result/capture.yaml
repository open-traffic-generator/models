openapi: 3.0.3
info:
  title: Capture results models
  version: ^0.0.0
components:
  schemas:
    Capture.Request:
      description: |-
        The capture result request to the traffic generator.
        Stops the port capture on the port_name and returns the capture.
      type: object
      required: [port_name]
      properties:
        port_name:
          description: >-
            The name of a port a capture is started on.
          type: string
          x-constraint:
          - '/components/schemas/Port/properties/name'
          x-field-uid: 1
        packets:
          description: >-
            Specification of the packets to be returned in the capture result from 
            the set of captured packets as per capture configuration.
          $ref: '#/components/schemas/CaptureRequest.Packets'
          x-field-uid: 2

    CaptureRequest.Packets:
      description: >-
        Packets to be returned in the capture result from 
        the set of captured packets as per capture configuration.
      type: object
      properties:
        choice:
          type: string
          default: all
          x-field-uid: 1
          x-enum:
            all:
              x-field-uid: 1
            slice:
              x-field-uid: 2
        slice:
          $ref: '#/components/schemas/CaptureRequest.CaptureSlice'
          x-field-uid: 2

    CaptureRequest.CaptureSlice:
      description: |-
        Packets to be returned as part of the capture result from the set of captured packets as per 
        capture configuration and specification of capture slice.
        To be noted,
        - definition of capture slice works in conjunction with capture filter parameters in set_config.
        - if 'initial' set of packets is desired to be returned in the capture result, 'overwrite' attribute in 'captures' 
          settings of set_config should be disabled.
      type: object
      properties:
        choice:
          type: string
          default: initial
          x-field-uid: 1
          x-enum:
            initial:
              x-field-uid: 1
        initial:
          $ref: '#/components/schemas/CaptureRequest.CaptureSliceInitial'
          x-field-uid: 2

    CaptureRequest.CaptureSliceInitial:
      description: >-
        Specification of capture slice to retrieve captured packets from begining of captured packet sequence.
      type: object
      properties:
        start:
          description: >-
            Position of the packet (Nth) in the captured packet sequence starting from which 
            packets would be returned as part of the capture result.
          type: integer
          format: uint64
          minimum: 1
          default: 1
          x-field-uid: 1
        count:
          description: >-
            Maximum number of packets to be returned as part of the capture result starting from the position of 'start' packet.
          type: integer
          format: uint64
          minimum: 1
          default: 100
          x-field-uid: 2 