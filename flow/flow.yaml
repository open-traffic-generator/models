components:
  schemas:
    Flow:
      x-include: 
      - '../common/common.yaml#/components/schemas/Named.Object'
      description: |- 
        A high level data plane traffic flow.
      type: object
      required: [tx_rx]
      properties:
        tx_rx:
          description: |-
            The transmit and receive endpoints.
          $ref: './endpoint.yaml#/components/schemas/Flow.TxRx'
        packet:
          description: |-
            The header is a list of traffic protocol headers.
            The order of traffic protocol headers assigned to the list is the
            order they will appear on the wire.
          type: array
          minItems: 1
          items:
            $ref: './packet-headers/header.yaml#/components/schemas/Flow.Header'
        size:
          description: |-
            The size of the packets.
          $ref: './size.yaml#/components/schemas/Flow.Size'
        rate:
          description: |-
            The transmit rate of the packets.
          $ref: './rate.yaml#/components/schemas/Flow.Rate'
        duration:
          description: |-
            The transmit duration of the packets.
          $ref: './duration.yaml#/components/schemas/Flow.Duration'
        metrics:
          description: |-
            Flow metrics. 
          $ref: '#/components/schemas/Flow.Metrics'
    
    Flow.Metrics:
      description: |-
        The optional container for configuring flow metrics.
      type: object
      properties:
        enable:
          description: |-
            Enables flow metrics.
            Enabling this option may affect the resultant packet payload due to 
            additional instrumentation data.
          type: boolean
          default: false
        loss:
          description: |-
            Enables additional flow metric loss calculation.
          type: boolean
          default: false
        timestamps:
          description: |-
            Enables additional flow metric first and last timestamps.
          type: boolean
          default: false
        ports:
          description: |-
            Enables disaggregation of flow metrics by including metric groups of
            transmit and receive port names.
          type: boolean
          default: false
        latency:
          description: |-
            Latency metrics.
          $ref: '#/components/schemas/Flow.Latency.Metrics'

    Flow.Latency.Metrics:
      description: |-
        The optional container for per flow latency metric configuration.
      type: object
      properties:
        enable:
          description: |-
            True to enable latency metrics using timestamps.

            Enabling this option may affect the resultant packet payload due to 
            additional instrumentation data.
          type: boolean
          default: false
        mode:
          description: |-
            Select the type of latency measurement. The different types of 
            latency measurements are:
            

            store_forward:
            The time interval starting when the last bit of the frame leaves the
            sending port and ending when the first bit of the frame is seen on
            the receiving port (LIFO).  This is based on the RFC 1242 standard.


            cut_through:
            The time interval starting when the first bit of the frame leaves
            the sending port and ending when the first bit of the frame is seen
            on the receiving port (FIFO).  This is based on the RFC 1242 
            standard.
          type: string
          enum: 
          - store_forward
          - cut_through
          default: store_forward
      
