openapi: 3.0.3
info:
  title: Capture results models
  version: ^0.0.0
components:
  schemas:
    Capture.Request:
      description: >-
        The capture result request to the traffic generator.
        Stops the port capture on the port_name and returns the capture.
      type: object
      required: [port_name]
      properties:
        port_name:
          description: >-
            The name of a port a capture is started on.
          type: string
          x-constraint:
          - '/components/schemas/Port/properties/name'
          x-field-uid: 1
        packets:
          description: >-
            Specification of packets to be captured on the given port.
          $ref: '#/components/schemas/CaptureRequest.Packets'
          x-field-uid: 2

    CaptureRequest.Packets:
      type: object
      description: >-
        The packets to be captured on the given port.
      properties:
        choice:
          type: string
          default: all
          x-field-uid: 1
          x-enum:
            all:
              x-field-uid: 1
            slice:
              x-field-uid: 2
        slice:
          $ref: '#/components/schemas/CaptureRequest.CaptureSlice'
          x-field-uid: 2

    CaptureRequest.CaptureSlice:
      description: >-
        Packets to be captured based on specification of capture slice i.e. 
        position of first packet and count of packets to capture.
      type: object
      properties:
        start:
          description: >-
            Position of the packet (Nth) in the generated packet sequence from where capture would start.
          type: integer
          format: uint64
          minimum: 1
          default: 1
          x-field-uid: 1
        count:
          description: >-
            Number of packets to be captured from the position of first packet.
          type: integer
          format: uint64
          minimum: 1
          default: 100
          x-field-uid: 2 