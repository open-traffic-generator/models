components:
  schemas:
    FilterMetric:
      x-status:
        status: under_review
        information: There may be changes in filter_metric configuration
      description: >-
        Configuration for FilterMetrics settings.
      type: object
      required: [name]
      properties:
        association:
          description: >-
            Association.
          $ref: '#/components/schemas/FilterMetric.Association'
          x-field-uid: 1
        receive_filters:
          description: >-
            A list of filters to apply to the packet receiving ports.
            If no filters are specified then all packets will be counted.
            A filter_metric can have multiple filters. The number of filters supported
            is determined by the implementation.

            When multiple filters are specified then implementation must &&
            (and) all the filters.
          type: array
          items:
            $ref: '#/components/schemas/Filter.Packet'
          minItems: 1
          maxItems: 32
          x-field-uid: 2
        name:
          x-include: ../common/common.yaml#/components/schemas/Named.Object/properties/name
          x-field-uid: 3

    FilterMetric.Association:
      description: >-
        Configuration for filter_metric Association.
        Based on the association, filter_metric will be applied to count packets on per port or per flow.
      type: object
      properties:
        choice:
          description: |-
            The type of association.
          type: string
          x-field-uid: 1
          x-enum:
            port_names:
              x-field-uid: 1
            flow_names:
              x-field-uid: 2
        port_names:
          description: >-
            List of port names.
          type: array
          items:
            type: string
          x-constraint:
          - '/components/schemas/Port/properties/name'
          x-field-uid: 2
        flow_names:
          description: >-
            List of flow names.
          type: array
          items:
            type: string
          x-constraint:
          - '/components/schemas/Flow/properties/name'
          x-field-uid: 3

    Filter.Packet:
      description: >-
        Configuration for filter packets
      type: object
      required: [name]
      properties:
        name:
          x-include: ../common/common.yaml#/components/schemas/Named.Object/properties/name
          x-field-uid: 1
        choice:
          description: |-
            The type of packet filter.
          type: string
          default: custom
          x-field-uid: 2
          x-enum:
            custom:
              x-field-uid: 1
            ethernet:
              x-field-uid: 2
            vlan:
              x-field-uid: 3
            vxlan:
              x-field-uid: 4
            ipv4:
              x-field-uid: 5
            ipv6:
              x-field-uid: 6
            pfcpause:
              x-field-uid: 7
            ethernetpause:
              x-field-uid: 8
            tcp:
              x-field-uid: 9
            udp:
              x-field-uid: 10
            gre:
              x-field-uid: 11
            gtpv1:
              x-field-uid: 12
            gtpv2:
              x-field-uid: 13
            arp:
              x-field-uid: 14
            icmp:
              x-field-uid: 15
            icmpv6:
              x-field-uid: 16
            ppp:
              x-field-uid: 17
            igmpv1:
              x-field-uid: 18
            mpls:
              x-field-uid: 19
            snmpv2c:
              x-field-uid: 20
            rsvp:
              x-field-uid: 21
        custom:
          description: >-
            custom
          $ref: '#/components/schemas/Filter.Field.Custom'
          x-field-uid: 3
        ethernet:
          $ref: '../flow/packet-headers/ethernet.yaml#/components/schemas/Filter.Ethernet'
          x-field-uid: 4
        vlan:
          $ref: '../flow/packet-headers/vlan.yaml#/components/schemas/Filter.Vlan'
          x-field-uid: 5
        vxlan:
          $ref: '../flow/packet-headers/vxlan.yaml#/components/schemas/Filter.Vxlan'
          x-field-uid: 6
        ipv4:
          $ref: '../flow/packet-headers/ipv4.yaml#/components/schemas/Filter.Ipv4'
          x-field-uid: 7
        ipv6:
          $ref: '../flow/packet-headers/ipv6.yaml#/components/schemas/Filter.Ipv6'
          x-field-uid: 8
        pfcpause:
          $ref: '../flow/packet-headers/pfcpause.yaml#/components/schemas/Filter.PfcPause'
          x-field-uid: 9
        ethernetpause:
          $ref: '../flow/packet-headers/ethernetpause.yaml#/components/schemas/Filter.EthernetPause'
          x-field-uid: 10
        tcp:
          $ref: '../flow/packet-headers/tcp.yaml#/components/schemas/Filter.Tcp'
          x-field-uid: 11
        udp:
          $ref: '../flow/packet-headers/udp.yaml#/components/schemas/Filter.Udp'
          x-field-uid: 12
        gre:
          $ref: '../flow/packet-headers/gre.yaml#/components/schemas/Filter.Gre'
          x-field-uid: 13
        gtpv1:
          $ref: '../flow/packet-headers/gtp.yaml#/components/schemas/Filter.Gtpv1'
          x-field-uid: 14
        gtpv2:
          $ref: '../flow/packet-headers/gtpv2.yaml#/components/schemas/Filter.Gtpv2'
          x-field-uid: 15
        arp:
          $ref: '../flow/packet-headers/arp.yaml#/components/schemas/Filter.Arp'
          x-field-uid: 16
        icmp:
          $ref: '../flow/packet-headers/icmp.yaml#/components/schemas/Filter.Icmp'
          x-field-uid: 17
        icmpv6:
          $ref: '../flow/packet-headers/icmpv6.yaml#/components/schemas/Filter.Icmpv6'
          x-field-uid: 18
        ppp:
          $ref: '../flow/packet-headers/ppp.yaml#/components/schemas/Filter.Ppp'
          x-field-uid: 19
        igmpv1:
          $ref: '../flow/packet-headers/igmpv1.yaml#/components/schemas/Filter.Igmpv1'
          x-field-uid: 20
        mpls:
          $ref: '../flow/packet-headers/mpls.yaml#/components/schemas/Filter.Mpls'
          x-field-uid: 21
        snmpv2c:
          $ref: '../flow/packet-headers/snmpv2c.yaml#/components/schemas/Filter.Snmpv2c'
          x-field-uid: 22
        rsvp:
          $ref: '../flow/packet-headers/rsvp.yaml#/components/schemas/Filter.Rsvp'
          x-field-uid: 23

    Filter.Field.Custom:
      type: object
      properties:
        offset:
          type: integer
          format: uint32
          default: 0
          x-field-uid: 1
        value:
          x-include: '#/components/schemas/Filter.Field/properties/value'
          x-field-uid: 2
        mask:
          x-include: '#/components/schemas/Filter.Field/properties/mask'
          x-field-uid: 3

    Filter.Field:
      type: object
      properties:
        value:
          type: string
          format: hex
          default: "00"
          x-field-uid: 1
        mask:
          type: string
          format: hex
          default: "00"
          x-field-uid: 2