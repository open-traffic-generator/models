components:
  schemas:
    Egress.Header:
      description: >-
        List of all egress packet headers
      type: object
      properties:
        choice:
          description: >-
            The type of egress packet header
          type: string
          default: custom
          x-field-uid: 1
          x-enum:
            custom:
              x-field-uid: 1
            ethernet:
              x-field-uid: 2
            vlan:
              x-field-uid: 3
            ipv4:
              x-field-uid: 4
            ipv6:
              x-field-uid: 5
            mpls:
              x-field-uid: 6
        custom:
          $ref: '#/components/schemas/Egress.Custom'
          x-field-uid: 2
        ethernet:
          $ref: '#/components/schemas/Egress.Ethernet'
          x-field-uid: 3
        vlan:
          $ref: '#/components/schemas/Egress.Vlan'
          x-field-uid: 4
        ipv4:
          $ref: '#/components/schemas/Egress.Ipv4'
          x-field-uid: 5
        ipv6:
          $ref: '#/components/schemas/Egress.Ipv6'
          x-field-uid: 6
        mpls:
          $ref: '#/components/schemas/Egress.Mpls'
          x-field-uid: 7

    Egress.MetricGroup:
      description: >-
        Egress packet field metric_group details
      type: object
      properties:
        metric_group:
          description: >-
            A unique name is used to indicate to the system that the field may
            extend the metric row key and create an aggregate metric row for
            every unique value. To have metric group columns appear in the flow
            metric rows the flow metric request allows for the metric_group
            value to be specified as part of the request.
          type: string
          x-field-uid: 1
        offset:
          description: >-
            The offset into the packet header field at which to start tracking
            values.
          type: integer
          default: 0
          x-field-uid: 2
        length:
          description: >-
            The length in bits of the tracked values.
          type: integer
          default: 0
          x-field-uid: 3

    Egress.Custom:
      description: >-
        Custom packet header that can be used as a template for for protocols
        not yet defined
      type: object
      properties:
        header_length:
          description: >-
            The length of the custom packet header
          type: integer
          x-field-uid: 1
        field:
          description: >-
            A custom packet header field which will be offset from the start
            of this packet
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 2

    Egress.Ethernet:
      description: >-
        Ethernet packet header
      type: object
      properties:
        src:
          description: >-
            Source MAC address
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 1
        dst:
          description: >-
            Destination MAC address
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 2
        ether_type:
          description: >-
            Ethernet type
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 3
        pfc_queue:
          description: >-
            PFC queue
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 4

    Egress.Vlan:
      description: >-
        VLAN packet header
      type: object
      properties:
        priority:
          description: >-
            Priority
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 1
        cfi:
          description: >-
            Canonical Format Identifier
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 2
        id:
          description: >-
            VLAN identifier
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 3
        protocol:
          description: >-
            Ethernet type or length
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 4

    Egress.Ipv4:
      description: >-
        IPv4 packet header
      type: object
      properties:
        version:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 1
        header_length:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 2
        priority:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 3
        total_length:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 4
        identification:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 5
        reserved:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 6
        dont_fragment:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 7
        more_fragments:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 8
        fragment_offset:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 9
        time_to_live:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 10
        protocol:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 11
        header_checksum:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 12
        src:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 13
        dst:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 14

    Egress.Ipv6:
      description: >-
        IPv6 packet header
      type: object
      properties:
        version:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 1
        traffic_class:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 2
        flow_label:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 3
        payload_length:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 4
        next_header:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 5
        hop_limit:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 6
        src:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 7
        dst:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 8

    Egress.Mpls:
      description: >-
        MPLS packet header
      type: object
      properties:
        label:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 1
        traffic_class:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 2
        bottom_of_stack:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 3
        time_to_live:
          $ref: '#/components/schemas/Egress.MetricGroup'
          x-field-uid: 4
