components:
  schemas:
    Bmp.Learned.Request:
      description: The request to retrieve BGP prefixes learned via BMP.
      type: object
      properties:
        peer_hashes:
          description: The hash identifiers of BGP peers for which learned prefix
            information will be retrieved. If no hashes are specified, the results
            will contain information for all monitored BGP peers.
          type: array
          items:
            type: string
          x-field-uid: 1
        prefix_filters:
          description: Specify which address families to return prefixes for. If the
            list is empty or missing, all prefixes will be returned.
          type: array
          items:
            type: string
            x-enum:
              ipv4_unicast:
                x-field-uid: 1
              ipv6_unicast:
                x-field-uid: 2
          x-field-uid: 2
        ipv4_unicast_filters:
          description: The IPv4 unicast results can be filtered by specifying additional
            prefix search criteria. If this property is missing or empty then all
            IPv4 prefixes will be returned.
          type: array
          items:
            $ref: '#/components/schemas/BgpPrefix.Ipv4Unicast.Filter'
          x-field-uid: 3
        ipv6_unicast_filters:
          description: The IPv6 unicast results can be filtered by specifying additional
            prefix search criteria. If this property is missing or empty then all
            IPv6 prefixes will be returned.
          type: array
          items:
            $ref: '#/components/schemas/BgpPrefix.Ipv6Unicast.Filter'
          x-field-uid: 4
    Bmp.LearnedInfo:
      description: Provides a comprehensive view of BGP prefixes as learned through
        BMP, separated into pre-policy and post-policy Adj-RIB-In views.
      type: object
      properties:
        pre_policy_prefixes:
          description: An array of BGP prefixes as they are received by the monitored
            router from its peer, *before* any inbound routing policies are applied.
            This represents the raw Adj-RIB-In.
          type: array
          items:
            $ref: '#/components/schemas/Bmp.LearnedPrefix'
          x-field-uid: 1
        post_policy_prefixes:
          description: An array of BGP prefixes that have been processed by the monitored
            router's inbound policies and are eligible for the BGP best-path selection
            process. This represents the post-policy Adj-RIB-In.
          type: array
          items:
            $ref: '#/components/schemas/Bmp.LearnedPrefix'
          x-field-uid: 2
    Bmp.LearnedPrefix:
      description: Represents a single BGP unicast prefix and its associated path
        attributes as captured by a BMP station.
      type: object
      properties:
        action:
          description: Indicates the event type for this prefix entry. 'add' signifies
            a new prefix announcement or an update to an existing path. 'del' signifies
            a prefix withdrawal. For 'del' actions, most path attribute fields will
            be null or empty.
          type: string
          x-field-uid: 1
        sequence:
          description: A 64-bit unsigned sequence number that increments for each
            prefix record generated for a specific peer. This helps in ordering events
            and detecting missed updates. It resets on collector restart.
          type: integer
          format: uint64
          x-field-uid: 2
        hash:
          description: A unique hash identifier for this specific prefix entry, generated
            by the collector. It is typically a hash of the prefix, prefix length,
            peer hash, and path_id, ensuring uniqueness for each path.
          type: string
          x-field-uid: 3
        router_hash:
          description: A unique hash identifier for the monitored router sending BMP
            data, generated by the collector.
          type: string
          x-field-uid: 4
        router_ip:
          description: The source IP address (IPv4 or IPv6) of the monitored router.
          type: string
          x-field-uid: 5
        base_attr_hash:
          description: A hash identifier for the set of BGP path attributes associated
            with this prefix. Prefixes that share the exact same set of attributes
            will have the same base attribute hash.
          type: string
          x-field-uid: 6
        peer_hash:
          description: A unique hash identifier for the BGP peer from which the prefix
            was learned, generated by the collector.
          type: string
          x-field-uid: 7
        peer_ip:
          description: The remote IP address (IPv4 or IPv6) of the BGP peer.
          type: string
          x-field-uid: 8
        peer_asn:
          description: The Autonomous System Number (ASN) of the remote BGP peer.
          type: integer
          format: uint32
          x-field-uid: 9
        timestamp:
          description: The timestamp when the BMP message for this prefix was processed
            by the collector, formatted as 'YYYY-MM-DD HH:MM:SS.ffffff'.
          type: string
          x-field-uid: 10
        prefix:
          description: The network prefix, represented as an IPv4 or IPv6 address.
          type: string
          x-field-uid: 11
        prefix_length:
          description: The length of the network prefix in bits (e.g., 24 for a /24).
          type: integer
          x-field-uid: 12
        is_ipv4:
          description: A boolean flag that is true if the prefix is an IPv4 address,
            and false if it is an IPv6 address.
          type: boolean
          x-field-uid: 13
        origin:
          description: The origin of the path information, indicating how the route
            was introduced into BGP. 'igp' means the route originated within the AS.
            'egp' means it was learned via the Exterior Gateway Protocol. 'incomplete'
            means the origin is unknown, often indicating redistribution from another
            routing protocol.
          type: string
          x-enum:
            igp:
              x-field-uid: 1
            egp:
              x-field-uid: 2
            incomplete:
              x-field-uid: 3
          x-field-uid: 14
        as_path:
          description: A string representation of the BGP AS_PATH attribute, listing
            the sequence of Autonomous Systems the update has traversed.
          type: string
          x-field-uid: 15
        as_path_count:
          description: The number of Autonomous Systems in the AS_PATH.
          type: integer
          x-field-uid: 16
        origin_as:
          description: The originating ASN for this prefix, which is the right-most
            ASN in the AS_PATH sequence.
          type: integer
          format: uint32
          x-field-uid: 17
        next_hop:
          description: The IP address (IPv4 or IPv6) of the next-hop router to reach
            the destination prefix.
          type: string
          x-field-uid: 18
        multi_exit_discriminator:
          description: The Multi-Exit Discriminator (MED) value. It is used as a suggestion
            to an external neighbor about the preferred path into the advertising
            AS. A lower MED value is preferred.
          type: integer
          format: uint32
          x-field-uid: 19
        local_preference:
          description: The Local Preference value. This attribute is used within an
            AS to choose the preferred exit point for traffic. A higher local preference
            value is preferred.
          type: integer
          format: uint32
          x-field-uid: 20
        aggregator:
          description: 'A string identifying the BGP router (by its ASN and IP address)
            that performed route aggregation to create this summary prefix. Format:
            ''{as} {IP}''.'
          type: string
          x-field-uid: 21
        communities:
          description: A string representation of the standard BGP communities associated
            with the prefix.
          type: string
          x-field-uid: 22
        extended_communities:
          description: A string representation of the BGP Extended Communities associated
            with the prefix, used for more complex policy signaling (e.g., VPNs, traffic
            engineering).
          type: string
          x-field-uid: 23
        cluster_list:
          description: A string representation of the CLUSTER_LIST attribute, which
            contains a sequence of Cluster IDs that the route has passed through.
            Used by Route Reflectors for loop prevention.
          type: string
          x-field-uid: 24
        is_atomic_aggregate:
          description: A boolean flag that is true if the ATOMIC_AGGREGATE attribute
            is set. This indicates that the prefix is a summary route and that more
            specific path information has been lost.
          type: boolean
          x-field-uid: 25
        is_next_hop_ipv4:
          description: A boolean flag that is true if the next_hop address is IPv4,
            and false if it is IPv6.
          type: boolean
          x-field-uid: 26
        originator_id:
          description: The router ID of the BGP speaker that originated the route
            within an AS. This attribute is used by Route Reflectors for loop prevention.
          type: string
          x-field-uid: 27
        path_id:
          description: A 32-bit unsigned integer that identifies a path for a given
            prefix. It is used by the BGP Add-Paths feature to advertise multiple
            paths for the same prefix. A value of zero indicates Add-Paths is not
            used.
          type: integer
          format: uint32
          x-field-uid: 28
        labels:
          description: A comma-delimited string of MPLS labels associated with the
            prefix, as received in the BGP update.
          type: string
          x-field-uid: 29
        is_pre_policy:
          description: A boolean flag that is true if this prefix view is from the
            Adj-RIB-In *before* inbound policies were applied, and false if it is
            from *after* policies were applied.
          type: boolean
          x-field-uid: 30
        is_adj_in:
          description: A boolean flag that is true if the prefix was learned from
            a peer (Adj-RIB-In), and false if it is being advertised to a peer (Adj-RIB-Out).
            For learned prefix info, this is typically true.
          type: boolean
          x-field-uid: 31
        large_communities:
          description: A string representation of BGP Large Communities, which provide
            a 12-byte format for expanded community signaling capabilities.
          type: string
          x-field-uid: 32
