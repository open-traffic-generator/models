components:
  schemas:
    AdvancedMetrics.Request:
      description: >-
        The request container for flow metrics.
        These metrics will not be available if the property 
        /components/schemas/Flow/properties/metrics is false.
      type: object
      properties:
        flow_names:
          description: >-
            The names of flow objects to return results for.
            An empty list will return results for all flows.
          type: array
          items:
            type: string
          x-constraint:
          - "/components/schemas/Flow/properties/name"
        metric_names:
          description: >-
            The list of metric names that the returned result set will contain.
            If the list is empty then all metrics will be returned but will be
            aggregated by flow name, the metrics will not be broken down by 
            additional metric group names.
            The name of the flow cannot be excluded from the response.
          type: array
          items:
            type: string
            enum:
              - transmit
              - port_tx
              - port_rx
              - frames_tx
              - frames_rx
              - bytes_tx
              - bytes_rx
              - frames_tx_rate
              - frames_rx_rate
              - loss
              - timestamps
              - latency
        metric_group_names:
          description: >-
            Extend the advanced flow metrics response by specifying any 
            configured flow packet header field metric_group names.
          type: array
          items:
            type: string
          x-constraint:
            - "/components/schemas/Flow.Pattern/properties/metric_group"
            
    AdvancedMetrics.Response:
      type: array
      items:
        $ref: '#/components/schemas/AdvancedMetrics.Flow'

    AdvancedMetrics.Flow:
      type: object
      properties:
        name:
          description: >-
            The name of the advanced flow metric response. 
            The name includes the flow name by default along with any requested 
            metric_group_names.
          type: string
          example: 'Tx -> Rx'
        transmit:
          description: >-
            The transmit state of the flow.
          type: string
          enum: [started, stopped, paused]
        port_tx:
          description: >-
            The name of a configured port that the flow is being transmitted 
            from.
          type: string
          x-constraint:
          - "/components/schemas/Port/properties/name"
        port_rx:
          description: >-
            The name of a configured port that the flow is being recevied on.
          type: string
          x-constraint:
          - "/components/schemas/Port/properties/name"
        frames_tx:
          description: >-
            The current total number of frames transmitted
          type: integer
        frames_rx:
          description: >-
            The current total number of valid frames received
          type: integer
        bytes_tx:
          description: >-
            The current total number of bytes transmitted
          type: integer
        bytes_rx:
          description: >-
            The current total number of bytes received
          type: integer
        frames_tx_rate:
          description: >-
            The current rate of frames transmitted
          type: number
        frames_rx_rate:
          description: >-
            The current rate of valid frames received
          type: number
        loss:
          description: >-
            The percentage of lost frames
          type: number
        timestamps:
          $ref: '#/components/schemas/AdvancedMetrics.Timestamp'
        latency:
          $ref: '#/components/schemas/AdvancedMetrics.Latency'

    AdvancedMetrics.Timestamp:
      description: |-
        The container for timestamp metrics.
      type: object
      properties:
        first_timestamp_ns:
          description: |-
            First timestamp in nanoseconds
          type: number
          format: double
        last_timestamp_ns:
          description: |-
            Last timestamp in nanoseconds
          type: number
          format: double

    AdvancedMetrics.Latency:
      description: |-
        The container for latency metrics. The min/max/avg values are dependent 
        on the type of latency measurement mode that is configured.
      type: object
      properties:
        minimum_ns:
          description: |-
            Minimum latency in nanoseconds
          type: number
          format: double
        maximum_ns:
          description: |-
            Maximum latency in nanoseconds
          type: number
          format: double
        average_ns:
          description: |-
            Average latency in nanoseconds
          type: number
          format: double
