components:
  schemas:
    Flow.Ipv6Routing:
      description: Ipv6 Routing extension packet header
      type: object
      properties:
        choice:
          type: string
          default: segment_routing
          x-field-uid: 1
          x-enum:
            segment_routing:
              x-field-uid: 1
        segment_routing:
          $ref: '#/components/schemas/Flow.Ipv6SegmentRouting'
          x-field-uid: 2
    Flow.Ipv6SegmentRouting:
      description: Defines the structure of the IPv6 Segment Routing Header (SRH)
        with Routing Type 4. This header is an IPv6 Routing header used to specify
        a source-routed path for a packet, guiding it through a sequence of Segment
        IDs (SIDs), which are typically IPv6 addresses.
      type: object
      properties:
        next_header:
          x-field-pattern:
            description: 8-bit selector that identifies the type of header immediately
              following the SRH. It uses the same values as the IPv4 Protocol field.
              The default value 59 indicates that there is no next header.
            format: integer
            length: 8
            default: 59
            x-constants:
              tcp: 6
              udp: 17
              ipv6: 41
              ipv6_route: 43
              ipv6_frag: 44
              esp: 50
              ah: 51
              ipv6_icmp: 58
              ipv6_nonxt: 59
              ipv6_opts: 60
              mobility_header: 135
              sctp: 132
            features: [auto, count]
          x-field-uid: 1
        hdr_ext_len:
          x-field-pattern:
            description: 8-bit unsigned integer specifying the length of the SRH in
              8-octet units, not including the first 8 octets of the SRH itself.
            format: integer
            length: 8
            default: 2
            features:
              - count
          x-field-uid: 2
        routing_type:
          x-field-pattern:
            description: 8-bit identifier for the Routing header variant. For the
              Segment Routing Header, this value is always 4.
            format: integer
            length: 8
            default: 4
            x-constants:
              srh: 4
            features:
              - count
          x-field-uid: 3
        segments_left:
          x-field-pattern:
            description: 8-bit unsigned integer containing the number of remaining
              segments to be visited before the packet reaches its final destination.
              It is decremented at each segment endpoint. It points to the current
              active segment in the Segment List.
            format: integer
            length: 8
            default: 0
            features:
              - count
          x-field-uid: 4
        last_entry:
          x-field-pattern:
            description: 8-bit unsigned integer that contains the zero-based index
              of the last element in the Segment List array. For example, if the Segment
              List contains 3 addresses (at indices 0, 1, 2), the value of Last Entry
              is 2.
            format: integer
            length: 8
            default: 0
            features:
              - count
          x-field-uid: 5
        flags:
          $ref: '#/components/schemas/Flow.Ipv6SegmentRouting.Flags'
          x-field-uid: 6
        tag:
          x-field-pattern:
            description: 16-bit field used to tag a packet as part of a class or group,
              enabling shared properties or policy treatment. If not used, it MUST
              be set to zero.
            format: integer
            length: 16
            default: 0
            features:
              - count
          x-field-uid: 7
        segment_list:
          x-field-pattern:
            description: The second 128-bit IPv6 address in the Segment List (Segment
              List[1]). This represents the penultimate segment of the path. The list
              can contain multiple segments, each represented by a subsequent 'segment_list_n'
              field.
            format: ipv6
            default: '::'
            features:
              - count
          x-field-uid: 8
        tlvs:
          $ref: '#/components/schemas/Flow.Ipv6SegmentRouting.Tlvs'
          x-field-uid: 9
    Flow.Ipv6SegmentRouting.Tlvs:
      description: A list of optional Type-Length-Value (TLV) objects that carry
        metadata for segment processing. TLVs are only present if the Hdr Ext
        Len is greater than what is required for the fixed header and the segment
        list.
      type: object
      properties:
        ingress:
          $ref: '#/components/schemas/Flow.Ipv6SegmentRouting.TlvIngressNode'
          x-field-uid: 1
        egress:
          $ref: '#/components/schemas/Flow.Ipv6SegmentRouting.TlvEgressNode'
          x-field-uid: 2
        opaque:
          $ref: '#/components/schemas/Flow.Ipv6SegmentRouting.TlvOpaqueContainer'
          x-field-uid: 3
        padding:
          $ref: '#/components/schemas/Flow.Ipv6SegmentRouting.TlvPad'
          x-field-uid: 4
        hmac:
          $ref: '#/components/schemas/Flow.Ipv6SegmentRouting.TlvHmac'
          x-field-uid: 5
        path_trace:
          $ref: '#/components/schemas/Flow.Ipv6SegmentRouting.TlvPathTrace'
          x-field-uid: 6
    Flow.Ipv6SegmentRouting.Flags:
      description: An 8-bit field containing flags. While RFC 8754 reserves all
        bits as unused, earlier drafts defined specific flags for behavior such
        as OAM, HMAC, and FRR protection.
      type: object
      properties:
        u1_flag:
          x-field-pattern:
            description: Unused bit. Should be set to 0.
            format: integer
            length: 1
            default: 0
            features:
              - count
          x-field-uid: 1
        p_flag:
          x-field-pattern:
            description: Protected Flag. Indicates if the segment is protected
              by a Fast Re-Route (FRR) mechanism.
            format: integer
            length: 1
            default: 0
            x-constants:
              not_protected: 0
              protected: 1
            features:
              - count
          x-field-uid: 2
        o_flag:
          x-field-pattern:
            description: OAM Flag. Indicates if the packet is an Operations, Administration,
              and Maintenance (OAM) packet.
            format: integer
            length: 1
            default: 0
            x-constants:
              not_oam: 0
              oam: 1
            features:
              - count
          x-field-uid: 3
        a_flag:
          x-field-pattern:
            description: Alert Flag. Indicates the presence of important TLVs
              that must be inspected.
            format: integer
            length: 1
            default: 0
            x-constants:
              no_alert: 0
              alert: 1
            features:
              - count
          x-field-uid: 4
        h_flag:
          x-field-pattern:
            description: HMAC Flag. Indicates the presence of the HMAC TLV for
              verification.
            format: integer
            length: 1
            default: 0
            x-constants:
              no_hmac: 0
              hmac_present: 1
            features:
              - count
          x-field-uid: 5
        u2_flag:
          x-field-pattern:
            description: Unused 3 bits. Should be set to 0.
            format: integer
            length: 3
            default: 0
            features:
              - count
          x-field-uid: 6
    Flow.Ipv6SegmentRouting.TlvPad:
      description: Padding TLV used when more than one byte of padding is required
        to align subsequent TLVs or pad the header to an 8-octet boundary.
      type: object
      properties:
        type:
          x-field-pattern:
            description: Type identifier for PadN TLV. Always 4.
            format: integer
            length: 8
            default: 4
            features:
              - count
          x-field-uid: 1
        length:
          x-field-pattern:
            description: The length of the Padding field in bytes. Can range from
              0 to 5.
            format: integer
            length: 8
            default: 0
            features:
              - count
          x-field-uid: 2
        padding:
          description: Variable-length padding bytes. Must be set to 0 on transmission.
          type: string
          format: hex
          default: '00'
          x-field-uid: 3
    Flow.Ipv6SegmentRouting.TlvHmac:
      description: Keyed-Hash Message Authentication Code (HMAC) TLV used to verify
        that the SRH was not modified en route and was generated by an authorized
        source.
      type: object
      properties:
        type:
          x-field-pattern:
            description: Type identifier for HMAC TLV. Always 5.
            format: integer
            length: 8
            default: 5
            x-constants:
              hmac: 5
            features:
              - count
          x-field-uid: 1
        length:
          x-field-pattern:
            description: The length of the variable-length data (D-bit, Reserved,
              Key ID, and HMAC) in bytes.
            format: integer
            length: 8
            default: 38
            features:
              - count
          x-field-uid: 2
        d_bit:
          x-field-pattern:
            description: Destination Address verification disabled flag. If set to
              1, verification of the destination address against the current segment
              is disabled.
            format: integer
            length: 1
            default: 0
            features:
              - count
          x-field-uid: 3
        reserved:
          x-field-pattern:
            description: 15 reserved bits. Must be set to 0.
            format: integer
            length: 15
            default: 0
            features:
              - count
          x-field-uid: 4
        hmac_key_id:
          x-field-pattern:
            description: A 32-bit opaque identifier for the pre-shared key and algorithm
              used to generate the HMAC.
            format: integer
            length: 32
            default: 0
            features:
              - count
          x-field-uid: 5
        hmac:
          x-field-pattern:
            description: The HMAC digest, truncated to 32 octets. Its length must
              be a multiple of 8 octets.
            format: mac
            type: string
            default: 00:00:00:00:00:00
            features:
              - count
          x-field-uid: 6
    Flow.Ipv6SegmentRouting.TlvIngressNode:
      description: A TLV that may be used to carry the IPv6 address of the ingress
        node of the SR domain.
      type: object
      properties:
        type:
          x-field-pattern:
            description: Type identifier for Ingress Node TLV.
            format: integer
            length: 8
            default: 1
            x-constants:
              ingress_node: 1
            features:
              - count
          x-field-uid: 1
        length:
          x-field-pattern:
            description: Length of the TLV value in bytes.
            format: integer
            length: 8
            default: 18
            features:
              - count
          x-field-uid: 2
        reserved:
          x-field-pattern:
            description: Reserved field. Must be 0.
            format: integer
            length: 8
            default: 0
            features:
              - count
          x-field-uid: 3
        flags:
          x-field-pattern:
            description: 8-bit flags field for this TLV.
            format: integer
            length: 8
            default: 0
            features:
              - count
          x-field-uid: 4
        value:
          x-field-pattern:
            description: The 128-bit IPv6 address of the ingress node.
            format: ipv6
            default: '::'
            features:
              - count
          x-field-uid: 5
    Flow.Ipv6SegmentRouting.TlvEgressNode:
      description: A TLV that identifies the egress node of the SR policy.
      type: object
      properties:
        type:
          x-field-pattern:
            description: The type identifier for the Egress Node TLV.
            format: integer
            length: 8
            default: 2
            features:
              - count
          x-field-uid: 1
        length:
          x-field-pattern:
            description: The length of the Egress Node TLV's value field,
              in bytes.
            format: integer
            length: 8
            default: 18
            features:
              - count
          x-field-uid: 2
        reserved:
          x-field-pattern:
            description: Reserved field. Must be 0.
            format: integer
            length: 8
            default: 0
            features:
              - count
          x-field-uid: 3
        flags:
          x-field-pattern:
            description: 8-bit flags field for this TLV.
            format: integer
            length: 8
            default: 0
            features:
              - count
          x-field-uid: 4
        value:
          x-field-pattern:
            description: The 128-bit IPv6 address of the egress node.
            format: ipv6
            default: '::'
            features:
              - count
          x-field-uid: 5
    Flow.Ipv6SegmentRouting.TlvOpaqueContainer:
      description: A TLV used to carry opaque data across the SR domain.
      type: object
      properties:
        type:
          x-field-pattern:
            description: The type identifier for the Opaque Container TLV.
            format: integer
            length: 8
            default: 3
            features:
            - count
          x-field-uid: 1
        length:
          x-field-pattern:
            description: The length of the Opaque Container TLV's value field,
              in bytes.
            format: integer
            length: 8
            default: 18
            features:
            - count
          x-field-uid: 2
        value:
          description: The variable-length opaque data carried by the TLV.
          format: hex
          type: string
          default: '00'
          x-field-uid: 3
    Flow.Ipv6SegmentRouting.TlvPathTrace:
      description: A TLV used for path tracing and performance monitoring
        within the SR domain.
      type: object
      properties:
        type:
          x-field-pattern:
            description: The type identifier for the Path Trace TLV.
            format: integer
            length: 8
            default: 128
            features:
              - count
          x-field-uid: 1
        length:
          x-field-pattern:
            description: The length of the Path Trace TLV's value field, in
              bytes.
            format: integer
            length: 8
            default: 14
            features:
              - count
          x-field-uid: 2
        interface_id:
          x-field-pattern:
            description: Identifier of the interface where the measurement
              was taken.
            format: integer
            length: 12
            default: 0
            features:
              - count
          x-field-uid: 3
        interface_load:
          x-field-pattern:
            description: Load on the interface at the time of measurement.
            format: integer
            length: 4
            default: 0
            features:
              - count
          x-field-uid: 4
        timestamp:
          description: Timestamp indicating when the measurement was taken.
          format: hex
          type: string
          default: '00'
          x-field-uid: 5
        session_id:
          x-field-pattern:
            description: Identifier for the monitoring session.
            format: integer
            length: 16
            default: 0
            features:
              - count
          x-field-uid: 6
        sequence_number:
          x-field-pattern:
            description: Sequence number for the packet within the monitoring
              session.
            format: integer
            length: 16
            default: 0
            features:
              - count
          x-field-uid: 7
