components:
  schemas:
    Mka.Basic:
      description: >-
        A container of basic properties for a KaY.
      type: object
      properties:
        key_derivation_function:
          description: >-
            Key Derivation Function.
          type: string
          default: aes_cmac_128
          x-field-uid: 1
          x-enum:
            aes_cmac_128:
              x-field-uid: 1
            aes_cmac_256:
              x-field-uid: 2
        key_source:
          description: >-
            Key source.
          x-field-uid: 2
          $ref: './basic.yaml#/components/schemas/Mka.Basic.KeySource'
        actor_priority:
          description: |-
              Actor priority.
          type: string
          format: hex
          minLength: 2
          maxLength: 2
          default: "70"
          x-field-uid: 3
        macsec_desired:
          description: |-
            Determines whether MACsec is desired or not. It is advertised in periodic Hellos.
          type: boolean
          default: false
          x-field-uid: 4
        macsec_capability:
          description: |-
              MACSec Capability.
          type: string
          default: macsec_integrity_with_confidentiality_offset
          x-field-uid: 5
          x-enum:
            macsec_not_implemented:
              x-field-uid: 1
            macsec_integrity_without_confidentiality:
              x-field-uid: 2
            macsec_integrity_with_no_confidentiality_offset:
              x-field-uid: 3
            macsec_integrity_with_confidentiality_offset:
              x-field-uid: 4
        mka_version:
          description: |-
            MKA Version.
          type: integer
          format: uint32
          default: 3
          x-field-uid: 6
        mka_hello_time:
          description: |-
            MKA Hello Time (msec).
          type: integer
          format: uint32
          default: 2000
          x-field-uid: 7
        mka_life_time:
          description: |-
            MKA Life Time (sec).
          type: integer
          format: uint32
          default: 6
          x-field-uid: 8
        delay_protect:
          description: |-
            Delay Protect.
          type: integer
          format: uint32
          default: 6
          x-field-uid: 9
        rekey_mode:
          description: >-
            Rekey Mode.
          x-field-uid: 10
          $ref: './basic.yaml#/components/schemas/Mka.Basic.RekeyMode'

    Mka.Basic.KeySource:
      description: >-
        The container for static key settings.
      type: object
      properties:
        choice:
          description: |-
              Key source. Choose one from PSK or MSK. 
          type: string
          default: psk
          x-field-uid: 1
          x-enum:
            psk:
              x-field-uid: 1
            msk:
              x-field-uid: 2
        psks:
          description: |-
            Pre-shared Keys.
          type: array
          items:
            $ref: './basic.yaml#/components/schemas/Mka.Basic.KeySource.Psk'
          x-field-uid: 2

    Mka.Basic.KeySource.Psk:
      description: >-
        The container for Pre-shared key(PSK).
      type: object
      properties:
        cak_value:
          description: |-
              CAK value.
          type: string
          format: hex
          minLength: 16
          maxLength: 32
          default: "F123456789ABCDEF0123456789ABCDEF"     
          x-field-uid: 1
        cak_name:
          description: |-
              CAK name.
          type: string
          format: hex
          minLength: 1
          maxLength: 32
          default: "F123456789ABCDEF0123456789ABCDEFF123456789ABCDEF0123456789ABCDEF"
          x-field-uid: 2
        start_time:
          description: |-
              Key start time in HH:MM.
          type: string
          default: "00:00"
          x-field-uid: 3
        end_time:
          description: |-
              Key end time in HH:MM.
          type: string
          default: "00:00"
          x-field-uid: 4

    Mka.Basic.RekeyMode:
      description: >-
        Rekey mode.
      type: object
      properties:
        choice:
          description: |-
              Mode choices.
          type: string
          default: dont_rekey
          x-field-uid: 1
          x-enum:
            dont_rekey:
              x-field-uid: 1
            timer_based:
              x-field-uid: 2
            pn_based:
              x-field-uid: 3
        timer_based:
          description: |-
              Container for timer based periodic rekey properties.
          x-field-uid: 2
          $ref: './basic.yaml#/components/schemas/Mka.Basic.RekeyMode.TimerBased'

    Mka.Basic.RekeyMode.TimerBased:
      description: >-
          Timer based periodic rekey properties.
      type: object
      properties:
        rekey_count:
          description: |-
              Periodic Rekey count.
          type: string
          default: continuous
          x-field-uid: 1
          x-enum:
            continuous:
              x-field-uid: 1
            fixed_count:
              x-field-uid: 2
        rekey_interval:
          description: |-
              Periodic Rekey Interval (sec).
          type: integer
          format: uint32
          minimum: 30
          maximum: 65535
          default: 300 
          x-field-uid: 2
