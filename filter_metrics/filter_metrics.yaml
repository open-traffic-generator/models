components:
  schemas:
    FilterMetric:
      x-status:
        status: under_review
        information: There may be changes in filter_metric configuration
      description: >-
        Configuration for FilterMetrics settings.
      type: object
      required: [name]
      properties:
        association:
          description: >-
            Association.
          $ref: '#/components/schemas/FilterMetric.Association'
          x-field-uid: 1
        receive_filters:
          description: >-
            A list of filters to apply to the packet receiving ports.
            If no filters are specified then all packets will be counted.
            A filter_metric can have multiple filters. The number of filters supported
            is determined by the implementation.

            When multiple filters are specified then implementation must &&
            (and) all the filters.
          type: array
          items:
            $ref: '../capture/capture.yaml#/components/schemas/Capture.Filter'
          minItems: 1
          maxItems: 32
          x-field-uid: 2
        name:
          x-include: ../common/common.yaml#/components/schemas/Named.Object/properties/name
          x-field-uid: 3

    FilterMetric.Association:
      description: >-
        Configuration for filter_metric Association.
        Based on the association, filter_metric will be applied to count packets on per port or per flow.
      type: object
      properties:
        choice:
          description: |-
            The type of association.
          type: string
          default: port_names
          x-field-uid: 1
          x-enum:
            port_names:
              x-field-uid: 1
            flow_names:
              x-field-uid: 2
        port_names:
          description: >-
            List of port names.
          type: array
          items:
            type: string
          x-constraint:
          - '/components/schemas/Port/properties/name'
          x-field-uid: 2
        flow_names:
          description: >-
            List of flow names.
          type: array
          items:
            type: string
          x-constraint:
          - '/components/schemas/Flow/properties/name'
          x-field-uid: 3   
