components:
  schemas:
    Bmp.Stats.Request:
      description: The request to retrieve BGP Monitoring Protocol (BMP) per-peer
        statistics.
      type: object
      properties:
        peer_hashes:
          description: A list of unique peer hash identifiers to retrieve statistics
            for. The hash is generated by the BMP collector to uniquely identify a
            peer. If this list is empty, statistics for all monitored peers will be
            returned, subject to other filters like router_hashes.
          type: array
          items:
            type: string
          x-field-uid: 1
        router_hashes:
          description: A list of unique router hash identifiers to retrieve statistics
            for. The hash is generated by the BMP collector to uniquely identify a
            monitored router. If this list is empty, statistics for peers on all monitored
            routers will be returned.
          type: array
          items:
            type: string
          x-field-uid: 2
        column_names:
          description: The list of column names that the returned result set will
            contain. If the list is empty then all columns will be returned. The peer_hash
            and router_hash cannot be excluded from the response.
          type: array
          items:
            type: string
            x-enum:
              action:
                x-field-uid: 1
              sequence:
                x-field-uid: 2
              router_ip:
                x-field-uid: 3
              peer_ip:
                x-field-uid: 4
              peer_asn:
                x-field-uid: 5
              timestamp:
                x-field-uid: 6
              prefixes_rejected:
                x-field-uid: 7
              known_dup_prefixes:
                x-field-uid: 8
              known_dup_withdraws:
                x-field-uid: 9
              invalid_cluster_list:
                x-field-uid: 10
              invalid_as_path:
                x-field-uid: 11
              invalid_originator_id:
                x-field-uid: 12
              invalid_as_confed:
                x-field-uid: 13
              prefixes_pre_policy:
                x-field-uid: 14
              prefixes_post_policy:
                x-field-uid: 15
          x-field-uid: 3
    Bmp.Stat:
      description: A collection of statistics for a monitored BGP peer, as reported
        by the BMP station. These statistics provide insights into the routing information
        being received from the peer.
      type: object
      properties:
        action:
          description: Indicates the type of statistics report. 'add' signifies a
            new or updated statistics entry for the peer.
          type: string
          x-field-uid: 1
        sequence:
          description: A 64-bit unsigned sequence number that increments for each
            statistics record generated for this specific peer. This can be used to
            order reports and detect if any reports were missed by the consumer. The
            sequence number will reset if the BMP collector is restarted.
          type: integer
          format: uint64
          x-field-uid: 2
        router_hash:
          description: A unique 32-byte hash identifier for the monitored router,
            generated by the BMP collector. This allows for consistent identification
            of the router across collector restarts or IP address changes.
          type: string
          x-field-uid: 3
        router_ip:
          description: The source IP address of the monitored router that is sending
            BMP messages to the collector. This can be an IPv4 or IPv6 address.
          type: string
          x-field-uid: 4
        peer_hash:
          description: A unique 32-byte hash identifier for the BGP peer, generated
            by the BMP collector. This serves as the primary key for identifying a
            specific BGP session's statistics.
          type: string
          x-field-uid: 5
        peer_ip:
          description: The remote IP address of the BGP peer. This can be an IPv4
            or IPv6 address.
          type: string
          x-field-uid: 6
        peer_asn:
          description: The Autonomous System Number (ASN) of the remote BGP peer.
          type: integer
          format: uint32
          x-field-uid: 7
        timestamp:
          description: The timestamp when the statistics record was generated by the
            collector, formatted as 'YYYY-MM-DD HH:MM:SS.ffffff'. This indicates the
            time of the event or the reporting interval.
          type: string
          example: '2023-10-27 10:30:00.123456'
          x-field-uid: 8
        prefixes_rejected:
          description: A counter for the number of prefixes that were rejected based
            on policy. This count represents routes that were received from the peer
            but discarded due to local import policies on the monitored router before
            they could be considered for the Loc-RIB.
          type: integer
          format: uint32
          x-field-uid: 9
        known_dup_prefixes:
          description: A counter for the number of duplicate BGP UPDATE messages received
            for prefixes that were already known. A high number may indicate path
            instability or redundant announcements from the peer.
          type: integer
          format: uint32
          x-field-uid: 10
        known_dup_withdraws:
          description: A counter for the number of duplicate BGP WITHDRAW messages
            received for prefixes that were not present or already withdrawn. This
            can indicate unnecessary churn or synchronization issues.
          type: integer
          format: uint32
          x-field-uid: 11
        invalid_cluster_list:
          description: A counter for BGP updates discarded because they failed the
            CLUSTER_LIST check. This occurs in a route reflector environment when
            an update is received that contains the local router's own cluster ID
            in the CLUSTER_LIST, indicating a routing loop within the reflection topology.
          type: integer
          format: uint32
          x-field-uid: 12
        invalid_as_path:
          description: A counter for BGP updates discarded due to an invalid AS_PATH
            attribute. This can happen if the update contains the local router's own
            ASN in the AS_PATH (a loop) or if the path is malformed.
          type: integer
          format: uint32
          x-field-uid: 13
        invalid_originator_id:
          description: A counter for BGP updates discarded because they failed the
            ORIGINATOR_ID check. In a route reflector setup, this occurs when an update
            is received with an ORIGINATOR_ID that matches the local router's BGP
            identifier, indicating a reflection loop.
          type: integer
          format: uint32
          x-field-uid: 14
        invalid_as_confed:
          description: A counter for BGP updates discarded due to a routing loop detected
            within a BGP confederation. This happens when a router receives an update
            containing its own member-AS number within the AS_CONFED_SEQUENCE or AS_CONFED_SET
            path attributes.
          type: integer
          format: uint32
          x-field-uid: 15
        prefixes_pre_policy:
          description: The total number of prefixes received from this peer and stored
            in the Adj-RIB-In *before* any inbound routing policies have been applied.
            This represents the complete set of routes advertised by the peer across
            all address families.
          type: integer
          format: uint64
          x-field-uid: 16
        prefixes_post_policy:
          description: The total number of prefixes from this peer that were accepted
            by inbound routing policies and are eligible for BGP best-path selection.
            This count reflects the content of the Adj-RIB-In *after* filtering. The
            difference between pre-policy and post-policy counts indicates the number
            of routes filtered by the local router's policies.
          type: integer
          format: uint64
          x-field-uid: 17